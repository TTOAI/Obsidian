
### Colab 런타임의 구조적 문제

- 공통 문제 (`numpy` / `torch` / `sentencepiece`)
	- C/C++로 작성된 핵심 모듈을 포함하고 있음
	- 순수 Python 코드뿐만 아니라 컴파일된 .so(공유 라이브러리, Linux)나 .pyd(Windows) 파일이 있음
	- 이런 모듈은 Python 인터프리터에 직접 로드되어 커널이 종료되기 전까지 실행 중인 상태로 유지됨
	- 런타임 중간에 버전을 교체하거나 다시 빌드하면 문제가 생김
	- 런타임 재시작 필요

- `numpy` / `torch`
	- 내부적으로 C/CUDA 레벨에서 다른 라이브러리와 연결(링킹) 되어 있어
	- 연결 구조는 ABI(Application Binary Interface) 라는 규약 위에서 동작함
	- 다른 버전의 라이브러리와 교체되면 구조체/심볼/메모리 레이아웃이 달라짐
	- 이미 로드된 상태로는 새 라이브러리와 호환이 안 됨
	- Colab 기본 환경에는 `numpy`와 `torch`가 이미 로드되어 있음
	- 이미 커널이 특정 버전의 `.so` 파일을 메모리에 올려둔 상태임
	- 새 버전이 덮어씌워지면 여러 문제 발생 가능
		- 기존 모듈이 메모리에서 해제되지 않음
		- 새 `.so`와 심볼 충돌
		- ImportError, segmentation fault, CUDA 초기화 실패 등 발생 가능
	- 런타임 재시작 필요

- sentencepiece
	- 단일 토크나이저 엔진을 C++로 구현하고 Python에서 불러오는 구조
	- Python은 이미 import된 C 모듈을 재로드할 수 없게 설계됨
	- `sentencepiece`가 import될 때 `_sentencepiece.so`가 커널 프로세스 메모리에 직접 로드됨
	- 이후에 `pip install sentencepiece`로 파일이 새로 덮어씌워져도, 이미 커널이 옛 `.so`를 로드한 상태라 새 파일을 인식하지 못함
	- 런타임 재시작 필요

