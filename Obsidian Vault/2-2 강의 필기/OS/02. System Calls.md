
# Protecting the System

- CPU는 user mode와 kernel mode가 있음
	- hardware의 mode bit를 통해 구분
	- 현대 CPU들은 두 가지 이상의 mode 지원
- Privileged instructions은 kernel mode에서만 실행 가능 (예: HLT in x86)
	- user mode에서 실행하려고 하면 exception 발생
	- OS나 다른 system component 보호

# Interrupt vs Exception

- interrupt
	- hardware device에 의해 발생
	- asynchronous (어느 때나 일어남)
- exception
	- software executing instructions에 의해 발생
	- synchronous
		- CPU가 instruction을 실행할 때 발생
	- trap: expected, intended
	- fault: unexpected

# Transition from User to Kernel Mode

- By system call
	- 보통 software에 의해 일어남
	- synchronous (명시적으로 요청되었을 때 일어남)
- By interrupt
	- 보통 hardware에 의해 일어남
	- asynchronous (어느 때나 일어남)
	- interrupt handler로 가기 전에 kernel mode로 전환됨

# System Call

- 프로그램이 OS에서 제공하는 서비스를 사용하기 위해 kernel에 요청할 때 사용하는 인터페이스
- high-level language(C/C++)를 통해 호출 가능
	- 시스템 콜은 OS에 종속적이므로 직접 호출 시 주의가 필요
- 프로그램이 API를 통해 접근 (예: Win32 API, POSIX API, Java API)

# Services Provided by the OS

- program execution
	- memory에 load, 실행, 종료
- I/O operations
- file-system manipulation
- communications
	- same computer or between computers over a network
- error detection
- resource allocation
- accounting (계정 관리)
	- 각 사용자가 시스템 자원을 얼마나 사용하는지 기록하고 관리
- protection and security

# Types of System Calls

- process control
	- fork(): process 생성
	- end(): normal terminaion
	- abort(): abnormal termination
- file management
- device management
- information maintenance
	- starce(): (Linux) 실행한 system call들을 list함
- communication
- protection

# OS Structure

- simple structure
	- 모듈로 나뉘지 않고 모든 운영체제 기능이 하나의 단일한 프로그램으로 구성
	- 최소한의 공간에서 최대한 많은 기능 제공
	- 구조가 있지만 잘 나뉘어 있지 않음
	- application이 HW에 직접 접근 가능
	- 단일 메모리 공간을 공유
	- shell 중심, shell을 통해 명령어를 입력하고 프로그램 실행
	- 프로그램을 load할 때 kernel과 CI(shell)의 작은 부분을 제외하고 모든 것을 덮어 씌움
	- 프로그램이 실행을 마치면 disk로부터 shell이 reload

- layered approach
	- 여러 개의 layer로 나누어 구성
	- layer 0: hardware, layer N: user interface
	- 각 layer는 바로 아래 layer의 기능과 서비스만을 사용
	- 상위 계층은 하위 계층의 세부 사항을 알 필요가 없으므로 추상화가 잘 이루어짐
	- Modular: 각 기능이 독립적인 모듈로 구성되어 있어, 확장성과 유지보수에 용이

- monolithic
	- 하나의 거대한 software system
	- 모든 주요 운영 체제 기능이 하나의 커널 안에 통합되어 운영됨
	- system-call interface와 physical hardware 사이에 존재하는 것들로 구성됨
vs
- microkerenl
	- 가능한 한 많은 것들을 kernel에서 user-space services로 옮김
	- user module들은 message passing을 이용해 상호작용
	- easier to extend: modular structure로 새로운 서비스를 추가할 수 있어 확장에 용이함
	- easier to port: port(모듈 이식)에 용이함
	- more reliable, sercure: kernel mode에서 실행되는 코드의 양이 적기 때문에, 시스템 전체의 안정성과 보안성이 높아짐
	- user space와 kernel space간의 통신에 performance overhead가 발생함

- modules
	- 많은 현대식 OS는 loadable kernel module을 지원
	- object-oriented approach
	- Each core component is separate
	- Each talks to the others over known interfaces
	- Each is loadable as needed within the kernel
	- more flexibility

# Hybrid Systems

- 많은 현대식 OS는 하나의 순수한 model이 아님
	- 다양한 시스템에서 여러 접근법들을 결합함

